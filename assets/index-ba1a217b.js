import{j as e,L as k,f as h,r as o,C as g,H as I,d as f,i as F}from"./index-ca0c0126.js";import{a as b,c as p,d as y,b as R,S as E}from"./product.query-446e1178.js";const P=({id:t,name:a,activeShopId:s})=>{const n=s===t;return e.jsx(k,{"aria-current":"true",to:`/shop/${t}`,type:"button",className:h("w-full px-4 py-2 font-medium text-left rtl:text-right rounded-none",n&&"text-white bg-blue-700 border-b border-gray-200 cursor-pointer focus:outline-none dark:bg-gray-800 dark:border-gray-600",!n&&"w-full px-4 py-2 font-medium text-left rtl:text-right border-b border-gray-200 cursor-pointer hover:bg-gray-100 hover:text-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:border-gray-600 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:ring-gray-500 dark:focus:text-white"),children:a})},T=async()=>await b({method:"get",url:"/product-shops"}),q=async t=>await b({method:"get",url:`/product-shops/${t}`}),L=()=>p({queryKey:[y],queryFn:()=>T().then(t=>t.data),staleTime:2e4}),$=t=>p({queryKey:[y,t],queryFn:()=>q(t).then(a=>a.data),staleTime:2e4}),A=({activeShopId:t})=>{const{data:a}=L();return e.jsx("div",{className:"col-span-3 bg-white h-fit overflow-y-auto",children:e.jsx("div",{className:"w-full text-sm font-medium text-gray-900 bg-white rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:a==null?void 0:a.map(s=>e.jsx(P,{name:s.title,id:s.id,activeShopId:t},s.id))})})},M=({item:t})=>{const{addToCart:a,addToFavourites:s,removeFromCart:n,removeFromFavourites:i,cartItems:r,favouriteItems:d}=o.useContext(g),u=()=>e.jsx("button",{onClick:()=>a(t,1),children:"Add to cart"}),x=()=>e.jsx("button",{onClick:()=>n(t.id),children:"Remove from cart"});return e.jsxs("div",{className:"bg-white rounded-2xl p-6 hover:-translate-y-2 transition-all relative flex flex-col",children:[e.jsx("button",{onClick:()=>d.includes(t.id)?i(t.id):s(t.id),className:h("bg-gray-100 w-10 h-10 flex cursor-pointer items-center justify-center rounded-full absolute top-4 right-4",d.includes(t.id)&&"bg-red-500"),children:e.jsx(I,{})}),e.jsx("div",{className:"w-11/12 h-[220px] overflow-hidden mx-auto aspect-w-16 aspect-h-8 md:mb-2 mb-4",children:e.jsx("img",{src:t.image,alt:`${t.title} - 205x220`,className:"h-full w-full object-contain"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:t.title}),e.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:[t.description.slice(0,60),"..."]}),e.jsxs("h4",{className:"text-lg text-gray-700 font-bold mt-4",children:["$",t.price," "]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[t.quantity!==0&&e.jsx(e.Fragment,{children:r.find(m=>m.id===t.id)?x():u()}),e.jsxs("span",{children:["qnty: ",t.quantity]})]})]})},_=12,G=()=>{const[t,a]=o.useState(!1),{sortBy:s,handleSortChange:n}=o.useContext(f),i=r=>{n(r),a(!1)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsxs("button",{onClick:()=>a(!t),type:"button",className:"inline-flex w-full justify-center gap-x-1.5 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",id:"menu-button","aria-expanded":"true","aria-haspopup":"true",children:[s?s.title:"Select sort",e.jsx("svg",{className:"-mr-1 h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"})})]})}),e.jsx("div",{className:h(!t&&"hidden","scale-95 absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"),role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabIndex:-1,children:e.jsx("div",{className:"py-1",role:"none",children:F.filter(r=>r.value!==(s==null?void 0:s.value)).map((r,d)=>e.jsx("button",{className:"text-gray-700 block px-4 py-2 text-sm",role:"menuitem",tabIndex:-1,onClick:()=>i(r),children:r.title},d))})})]})})},K=({products:t,title:a,hasMoreItems:s,shopId:n})=>{const{favouriteItems:i}=o.useContext(g),{sortBy:r}=o.useContext(f),[d,u]=o.useState(t),[x,m]=o.useState(1),[v,j]=o.useState(s),{refetch:w,data:c,isLoading:N}=R({skip:x*_,id:n,sort:r==null?void 0:r.value,automaticallyRunning:!1,favouriteProducts:r!=null&&r.value?i:[]}),C=()=>{w({})};return o.useEffect(()=>{c&&(r&&i.length>0?u(l=>[...l,...c.items.filter(S=>!i.includes(S.id))]):u(l=>[...l,...c.items]),j(c.hasMore),m(l=>l+1))},[c]),e.jsxs("div",{className:"p-4 mx-auto lg:max-w-7xl sm:max-w-full",children:[e.jsxs("div",{className:"flex justify-between w-full mb-6",children:[e.jsx("h2",{className:"text-4xl font-extrabold text-gray-800",children:a}),e.jsx("div",{className:"mt-1",children:e.jsx(G,{})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 min-h-screen",children:[e.jsx(A,{activeShopId:n}),e.jsxs("div",{className:"col-span-9 bg-gray-100 px-4 mt-6 sm:mt-0",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(l=>e.jsx(M,{item:l},l.id))}),v&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(E,{title:"Load more",onClick:C,disabled:N})})]})]})]})};export{K as S,$ as u};
